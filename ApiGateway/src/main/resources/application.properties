spring.application.name=ApiGateway

# Configuración del puerto del servicio
server.port=8080

# Registro en Eureka server
eureka.client.service-url.default-zone=http://localhost:8761/eureka
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.appname=${spring.application.name}
eureka.instance.instance-id=${spring.application.name}:${server.port}
eureka.instance.prefer-ip-address=true

# Habilitar el descubrimiento de servicios a través de Eureka
spring.cloud.gateway.server.webflux.discovery.locator.enabled=true
spring.cloud.gateway.server.webflux.discovery.locator.lower-case-service-id=true

# =================== RUTAS ===================

# ApiUsuarios
spring.cloud.gateway.server.webflux.routes[0].id=ApiUsuarios
spring.cloud.gateway.server.webflux.routes[0].uri=lb://ApiUsuarios
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/usuarios/**,/auth/**

# ApiEmpleado
spring.cloud.gateway.server.webflux.routes[1].id=ApiEmpleado
spring.cloud.gateway.server.webflux.routes[1].uri=lb://APIEMPLEADO
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/empleados/**

# ApiEspecialidad
spring.cloud.gateway.server.webflux.routes[2].id=ApiEspecialidad
spring.cloud.gateway.server.webflux.routes[2].uri=lb://APIESPECIALIDAD
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/especialidades/**

# ApiPaciente
spring.cloud.gateway.server.webflux.routes[3].id=ApiPaciente
spring.cloud.gateway.server.webflux.routes[3].uri=lb://APIPACIENTE
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/pacientes/**

# ApiHistoriaMedica
spring.cloud.gateway.server.webflux.routes[4].id=ApiHistoriaMedica
spring.cloud.gateway.server.webflux.routes[4].uri=lb://APIHISTORIAMEDICA
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/historias/**

# ApiCitaMedica
spring.cloud.gateway.server.webflux.routes[5].id=ApiCitaMedica
spring.cloud.gateway.server.webflux.routes[5].uri=lb://APICITAMEDICA
spring.cloud.gateway.server.webflux.routes[5].predicates[0]=Path=/citas-medicas/**

# ApiConsultorio
spring.cloud.gateway.server.webflux.routes[6].id=ApiConsultorio
spring.cloud.gateway.server.webflux.routes[6].uri=lb://APICONSULTORIO
spring.cloud.gateway.server.webflux.routes[6].predicates[0]=Path=/consultorios/**

# ApiDisponibilidad
spring.cloud.gateway.server.webflux.routes[7].id=ApiDisponibilidad
spring.cloud.gateway.server.webflux.routes[7].uri=lb://APIDISPONIBILIDAD
spring.cloud.gateway.server.webflux.routes[7].predicates[0]=Path=/disponibilidades/**

# ApiHorario
spring.cloud.gateway.server.webflux.routes[8].id=ApiHorario
spring.cloud.gateway.server.webflux.routes[8].uri=lb://APIHORARIO
spring.cloud.gateway.server.webflux.routes[8].predicates[0]=Path=/horarios/**

# ApiPago
spring.cloud.gateway.server.webflux.routes[9].id=ApiPago
spring.cloud.gateway.server.webflux.routes[9].uri=lb://APIPAGO
spring.cloud.gateway.server.webflux.routes[9].predicates[0]=Path=/pago-cita/**

spring.cloud.gateway.server.webflux.routes[10].id=ApiPago
spring.cloud.gateway.server.webflux.routes[10].uri=lb://APIPAGO
spring.cloud.gateway.server.webflux.routes[10].predicates[0]=Path=/comprobantes/**

# ApiAtencionMedica
spring.cloud.gateway.server.webflux.routes[11].id=ApiAtencionMedica
spring.cloud.gateway.server.webflux.routes[11].uri=lb://APIATENCIONMEDICA
spring.cloud.gateway.server.webflux.routes[11].predicates[0]=Path=/atenciones-medicas/**

# ============== CONFIGURACIÓN ADICIONAL ==============

# Timeouts
spring.cloud.gateway.server.webflux.httpclient.connect-timeout=3000
spring.cloud.gateway.server.webflux.httpclient.response-timeout=5000

# CORS
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-origins=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-methods=GET,POST,PUT,PATCH,DELETE
spring.cloud.gateway.server.webflux.globalcors.cors-configurations.[/**].allowed-headers=*


# ============== CONFIGURACIÓN JWT ==============
# Secret key para validar tokens JWT (debe coincidir con ApiUsuarios)
application.security.jwt.secret-key=${JWT_SECRET}

# Rutas públicas que no requieren autenticación JWT
# Formato: separadas por comas, soporta wildcards ** y *
application.security.public-paths=\
  /swagger-ui/**,/v3/api-docs/**,/api-docs/**,/h2-console/**,/auth/**,/citas-medicas/**,/consultorios/**,\
  /disponibilidades/**,/empleados/**,/especialidades/**,/historias/**,/horarios/**,/pacientes/**,/comprobantes/**,\
  /pago-cita/**,/usuarios/**,/atenciones-medicas/**

# DEBUGGING
# logging.level.org.springframework.cloud.gateway=DEBUG
# logging.level.reactor.netty.http.client=DEBUG